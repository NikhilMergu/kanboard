# Pass HTTP Authorization header via environment variable to PHP backend
# to make HTTP Basic Authentication work for Apache/FastCGI/php-fpm
# setups (required to authenticate over the API)
<IfModule mod_setenvif.c>
    SetEnvIf Authorization .+ HTTP_AUTHORIZATION=$0
</IfModule>

<IfModule mod_rewrite.c>
    Options -MultiViews

    SetEnv HTTP_MOD_REWRITE On

    # Uncomment this line depending of your Apache configuration
    # RewriteBase /

    RewriteEngine On

    # Deny access
    RewriteRule "^config(?:.default)?\.php" "-" [NC,F]
    RewriteRule "^web\.config" "-" [NC,F]
    RewriteRule "^(?:cli|ChangeLog|LICENSE)" "-" [NC,F]

    # Skip the deny rule for js, css and png
    RewriteCond "%{REQUEST_URI}" "^/(?:vendor|plugins)/.*\.(?:js|css|png)$"
    RewriteRule ".?" "-" [S=1]

    # Deny access to any non assets plugin files
    RewriteRule "^(?:vendor|plugins)/" "-" [NC,F]

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^ index.php [QSA,L]
    
    ############################
    ## Uncomment the two lines below to enable force HTTPS capabilities
    ############################
    
    # RewriteCond %{HTTPS} !=on 
    # RewriteRule ^/?(.*) https://%{SERVER_NAME}/$1 [R,L]
</IfModule>

<IfModule pagespeed_module>
    ModPagespeed Off
</IfModule>
